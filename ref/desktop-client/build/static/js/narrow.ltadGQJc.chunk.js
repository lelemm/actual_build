import{j as e,r as T,V as l,t as a,u as Qe,ad as G,aj as we,ak as Ce,a6 as R,aA as qe,aB as ee,aC as ze,am as Fe,aD as te,v as Re,aE as L,at as Be,aF as J,aG as $,aH as z,aI as H,T as P,E as Me,s as A,ao as Le,aJ as Ye,aK as X,aL as Je,ai as Ke,aM as ne,G as ue,aN as He,aO as Xe,aP as Ze,ax as De,aQ as k,aR as E,H as et,n as tt,aS as Te,aT as Ge,aU as nt,A as ot,aV as it,aW as st,aX as at,d as Z,aY as Se,aZ as rt,a_ as lt,a$ as dt,b0 as Ie,b1 as ct,b2 as ke,b3 as ut,b4 as gt,W as xt,b5 as mt,I as ft,b6 as Pe,b7 as $e,b8 as ht,b9 as pt,ba as Ee,bb as Ne,bc as yt,bd as bt,be as Ue,bf as jt,bg as St,bh as wt,aq as Ct,bi as Tt,bj as Pt,bk as vt,bl as Bt,bm as It,bn as kt,bo as At,bp as Wt,bq as zt,br as Ft,bs as Rt,bt as Mt,bu as Lt,bv as Ht,bw as Dt,bx as Gt,by as $t,bz as Et}from"./index.15_rIw78.js";import{u as Nt}from"./usePreviewTransactions.9E3yxDt5.chunk.js";const Ut=t=>e.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",style:{color:"inherit",...t.style},children:e.jsx("path",{d:"M10 7H2v6h8v5l8-8-8-8v5z",fill:"currentColor"})}),Vt=t=>e.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",style:{color:"inherit",...t.style},children:e.jsx("path",{d:"m3.828 9 6.071-6.071-1.414-1.414L0 10l.707.707 7.778 7.778 1.414-1.414L3.828 11H20V9H3.828z",fill:"currentColor"})});function Ot({onSync:t,children:n}){const[o,s]=T.useState(!1);async function u(){s(!0),await t(),s(!1)}return e.jsx(e.Fragment,{children:n({refreshing:o,onRefresh:u})})}const ve=T.forwardRef(({children:t,...n},o)=>e.jsx(l,{...n,ref:o,style:{marginTop:15,marginLeft:5,marginRight:5,borderRadius:6,backgroundColor:a.cardBackground,borderColor:a.cardBorder,boxShadow:"0 1px 2px #9594A8",...n.style},children:e.jsx(l,{style:{borderRadius:6,overflow:"hidden"},children:t})}));ve.displayName="Card";const _t=50,ge=({children:t,style:n,...o})=>e.jsx(l,{style:{height:_t,borderBottomWidth:1,borderColor:a.tableBorder,flexDirection:"row",alignItems:"center",paddingLeft:5,paddingRight:5,zIndex:1,...n},...o,children:t}),ce={borderRadius:16,color:a.pillText,backgroundColor:a.pillBackgroundLight};function U({show3Cols:t,isSidebar:n=!1,offset:o=0}={}){return n?t?`${35+o}vw`:`${45+o}vw`:t?`${20+o}vw`:`${25+o}vw`}function Qt({toBudget:t,onClick:n,show3Cols:o}){const s=X(t),u=te(),f=U({show3Cols:o,isSidebar:!0});return e.jsx(l,{style:{flexDirection:"row",justifyContent:"flex-start",alignItems:"center",width:f},children:e.jsxs(R,{type:"bare",style:{maxWidth:f},onPointerUp:r=>{r.stopPropagation(),n?.()},children:[e.jsxs(l,{children:[e.jsx(J,{title:s<0?"Overbudgeted":"To Budget",style:{...s<0?A.smallText:{},color:a.formInputText,flexShrink:0,textAlign:"left"}}),e.jsx($,{binding:t,type:"financial",formatter:r=>e.jsx(H,{as:P,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:f,fontSize:12,fontWeight:"700",color:s<0?a.errorText:a.formInputText},children:u(r,"financial")},r)})]}),e.jsx(ee,{style:{flexShrink:0,color:a.mobileHeaderTextSubdued,marginLeft:5},width:14,height:14})]})})}function qt({projected:t,onClick:n,show3Cols:o}){const s=t?z.totalBudgetedSaved:z.totalSaved,u=X(s)||0,f=te(),r=u<0,m=U({show3Cols:o,isSidebar:!0});return e.jsx(l,{style:{flexDirection:"row",justifyContent:"flex-start",alignItems:"center",width:m},children:e.jsxs(R,{type:"bare",style:{maxWidth:m},onPointerUp:x=>{x.stopPropagation(),n?.()},children:[e.jsxs(l,{children:[e.jsx(l,{children:t?e.jsx(H,{as:J,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",title:"Projected Savings",style:{maxWidth:m,color:a.formInputText,textAlign:"left",fontSize:12}}):e.jsx(J,{title:r?"Overspent":"Saved",style:{color:a.formInputText,textAlign:"left"}})}),e.jsx($,{binding:s,type:"financial",formatter:x=>e.jsx(H,{as:P,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:m,fontSize:12,fontWeight:"700",color:t?a.warningText:r?a.errorTextDark:a.formInputText},children:f(x,"financial")},x)})]}),e.jsx(ee,{style:{flexShrink:0,color:a.mobileHeaderTextSubdued,marginLeft:5},width:14,height:14})]})})}function Ve({name:t,binding:n,style:o,categoryId:s,month:u,onBudgetAction:f,...r}){const m=ne(),[x="rollover"]=G("budgetType"),p=`${x}-budget-menu`,c=()=>{m(k(p,{categoryId:s,month:u,onUpdateBudget:h=>{f(u,"budget-amount",{category:s,amount:h})},onCopyLastMonthAverage:()=>{f(u,"copy-single-last",{category:s})},onSetMonthsAverage:h=>{h!==3&&h!==6&&h!==12||f(u,`set-single-${h}-avg`,{category:s})},onApplyBudgetTemplate:()=>{f(u,"apply-single-category-template",{category:s})}}))};return e.jsx($,{binding:n,type:"financial",getStyle:He,"data-testid":t,onPointerUp:h=>{h.stopPropagation(),c()},...r})}const Yt=T.memo(function({type:n,category:o,isHidden:s,goal:u,longGoal:f,budgeted:r,spent:m,balance:x,carryover:p,index:c,blank:h,style:y,month:g,onEdit:M,onBudgetAction:i,show3Cols:S,showBudgetedCol:I}){const v=h?0:1,D=Ke("goalTemplatesEnabled"),O=X(u),V=D?O:null,[w="rollover"]=G("budgetType"),W=ne(),q=C=>{i(g,"carryover",{category:o.id,flag:C}),W(E(`${w}-balance-menu`))},K=X(n==="rollover"?L.catBalance(o.id):z.catBalance(o.id)),Y=X(r),B=X(x),_=X(f)===1,N=D?_?B:Y:null,oe=()=>{W(k("transfer",{title:o.name,month:g,amount:K,onSubmit:(C,be)=>{i(g,"transfer-category",{amount:C,from:o.id,to:be}),W(E(`${w}-balance-menu`))},showToBeBudgeted:!0}))},xe=()=>{W(k("cover",{title:o.name,month:g,onSubmit:C=>{i(g,"cover-overspending",{to:o.id,from:C}),W(E(`${w}-balance-menu`))}}))},me=()=>{W(k(`${w}-balance-menu`,{categoryId:o.id,month:g,onCarryover:q,...w==="rollover"&&{onTransfer:oe,onCover:xe}}))},fe=T.useRef(),ie=te(),he=ue(),pe=()=>{he(`/categories/${o.id}?month=${g}`)},ae=U({show3Cols:S,isSidebar:!0}),Q=U({show3Cols:S}),ye=e.jsxs(ge,{style:{backgroundColor:"transparent",borderBottomWidth:0,borderTopWidth:c>0?1:0,opacity:s?.5:void 0,...y},"data-testid":"row",innerRef:fe,children:[e.jsx(l,{style:{flex:1,justifyContent:"center",alignItems:"flex-start"},children:e.jsx(R,{type:"bare",style:{maxWidth:ae},onPointerUp:C=>{C.stopPropagation(),M?.(o.id)},children:e.jsxs(l,{style:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},children:[e.jsx(P,{style:{...A.lineClamp(2),width:ae,textAlign:"left",...A.smallText},"data-testid":"category-name",children:o.name}),e.jsx(ee,{style:{flexShrink:0,color:a.tableTextSubdued},width:14,height:14})]})})}),e.jsxs(l,{style:{justifyContent:"center",alignItems:"center",flexDirection:"row",opacity:v},children:[e.jsx(l,{style:{...!S&&!I&&{display:"none"},width:Q,justifyContent:"center",alignItems:"flex-end"},children:e.jsx(Ve,{name:"budgeted",binding:r,categoryId:o.id,month:g,onBudgetAction:i,formatter:C=>e.jsx(R,{type:"bare",style:{...ce,maxWidth:Q},children:e.jsx(H,{as:P,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:Q,textAlign:"right",fontSize:12},children:ie(C,"financial")},`${C}|${S}|${I}`)})})}),e.jsx(l,{style:{...!S&&I&&{display:"none"},justifyContent:"center",alignItems:"flex-end",width:Q},children:e.jsx($,{name:"spent",binding:m,getStyle:He,type:"financial",onPointerUp:C=>{C.stopPropagation(),pe()},formatter:C=>e.jsx(R,{type:"bare",style:{...ce,maxWidth:Q},children:e.jsx(H,{as:P,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:Q,textAlign:"right",fontSize:12},children:ie(C,"financial")},`${C}|${S}|${I}`)})})}),e.jsx(l,{style:{...A.noTapHighlight,justifyContent:"center",alignItems:"flex-end",width:Q},children:e.jsx("span",{role:"button",onPointerUp:C=>{C.stopPropagation(),me()},children:e.jsx(Xe,{carryover:p,balance:x,goal:u,budgeted:r,longGoal:f,formatter:C=>e.jsx(R,{type:"bare",style:{...ce,maxWidth:Q},children:e.jsx(H,{as:P,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:Q,...Ze(C,V,N),textAlign:"right",fontSize:12},children:ie(C,"financial")},C)}),carryoverIndicator:({style:C})=>e.jsx(l,{style:{position:"absolute",right:"-3px",top:"-5px",borderRadius:"50%",backgroundColor:C?.color??a.pillText},children:e.jsx(Ut,{width:11,height:11,style:{color:a.pillBackgroundLight}})})})})})]})]});return e.jsx(l,{children:ye})}),Jt=T.memo(function({group:n,budgeted:o,spent:s,balance:u,editMode:f,onEdit:r,blank:m,show3Cols:x,showBudgetedCol:p,collapsed:c,onToggleCollapse:h}){const y=m?0:1,g=T.useRef(),M=te(),i=U({show3Cols:x,isSidebar:!0,offset:-3.5}),S=U({show3Cols:x}),I=e.jsxs(ge,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:a.tableRowHeaderBackground,opacity:n.hidden?.5:void 0,paddingLeft:0},"data-testid":`expense-group-header-${n.name}`,innerRef:g,children:[e.jsxs(l,{style:{flex:1,flexDirection:"row",justifyContent:"flex-start",width:i},children:[e.jsx(R,{type:"bare",style:{flexShrink:0,color:a.pageTextSubdued,...A.noTapHighlight},activeStyle:{backgroundColor:"transparent"},hoveredStyle:{backgroundColor:"transparent"},onPointerUp:v=>{v.stopPropagation(),h?.(n.id)},children:e.jsx(De,{width:8,height:8,style:{flexShrink:0,transition:"transform .1s",transform:c?"rotate(-90deg)":""}})}),e.jsx(R,{type:"bare",style:{maxWidth:i},onPointerUp:v=>{v.stopPropagation(),r?.(n.id)},children:e.jsxs(l,{style:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},children:[e.jsx(P,{style:{...A.lineClamp(2),width:i,textAlign:"left",...A.smallText,fontWeight:"500"},"data-testid":"group-name",children:n.name}),e.jsx(ee,{style:{flexShrink:0,color:a.tableTextSubdued},width:14,height:14})]})})]}),e.jsxs(l,{style:{flexDirection:"row",justifyContent:"flex-end",alignItems:"center",opacity:y,paddingRight:5},children:[e.jsx(l,{style:{...!x&&!p&&{display:"none"},width:S,justifyContent:"center",alignItems:"flex-end"},children:e.jsx($,{binding:o,type:"financial",formatter:v=>e.jsx(H,{as:P,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:S,fontSize:12,fontWeight:"500",paddingLeft:5,textAlign:"right"},children:M(v,"financial")},v)})}),e.jsx(l,{style:{...!x&&p&&{display:"none"},width:S,justifyContent:"center",alignItems:"flex-end"},children:e.jsx($,{binding:s,type:"financial",formatter:v=>e.jsx(H,{as:P,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:S,fontSize:12,fontWeight:"500",paddingLeft:5,textAlign:"right"},children:M(v,"financial")},v)})}),e.jsx(l,{style:{width:S,justifyContent:"center",alignItems:"flex-end"},children:e.jsx($,{binding:u,type:"financial",formatter:v=>e.jsx(H,{as:P,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:S,fontSize:12,fontWeight:"500",paddingLeft:5,textAlign:"right"},children:M(v,"financial")},v)})})]})]});return I}),Kt=T.memo(function({group:n,budgeted:o,balance:s,onEdit:u,collapsed:f,onToggleCollapse:r}){const m=T.useRef(),x=te(),p=U({isSidebar:!0,offset:-13.5}),c=U();return e.jsxs(ge,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:a.tableRowHeaderBackground,opacity:n.hidden?.5:void 0,paddingLeft:0},innerRef:m,"data-testid":`income-group-header-${n.name}`,children:[e.jsxs(l,{style:{flex:1,flexDirection:"row",justifyContent:"flex-start",width:p},children:[e.jsx(R,{type:"bare",style:{flexShrink:0,color:a.pageTextSubdued,...A.noTapHighlight},activeStyle:{backgroundColor:"transparent"},hoveredStyle:{backgroundColor:"transparent"},onPointerUp:h=>{h.stopPropagation(),r?.(n.id)},children:e.jsx(De,{width:8,height:8,style:{flexShrink:0,transition:"transform .1s",transform:f?"rotate(-90deg)":""}})}),e.jsx(R,{type:"bare",style:{maxWidth:p},onPointerUp:h=>{h.stopPropagation(),u?.(n.id)},children:e.jsxs(l,{style:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},children:[e.jsx(P,{style:{...A.lineClamp(2),width:p,textAlign:"left",...A.smallText},"data-testid":"group-name",children:n.name}),e.jsx(ee,{style:{flexShrink:0,color:a.tableTextSubdued},width:14,height:14})]})})]}),e.jsxs(l,{style:{flexDirection:"row",justifyContent:"flex-end",alignItems:"center",paddingRight:5},children:[o&&e.jsx(l,{style:{justifyContent:"center",alignItems:"flex-end",width:c},children:e.jsx($,{binding:o,type:"financial",formatter:h=>e.jsx(H,{as:P,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:c,paddingLeft:5,textAlign:"right",fontSize:12,fontWeight:"500"},children:x(h,"financial")},h)})}),e.jsx(l,{style:{justifyContent:"center",alignItems:"flex-end",width:c},children:e.jsx($,{binding:s,type:"financial",formatter:h=>e.jsx(H,{as:P,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:c,paddingLeft:5,textAlign:"right",fontSize:12,fontWeight:"500"},children:x(h,"financial")},h)})})]})]})}),Xt=T.memo(function({index:n,category:o,budgeted:s,balance:u,month:f,style:r,onEdit:m,onBudgetAction:x}){const p=T.useRef(),c=te(),h=U({isSidebar:!0,offset:-10}),y=U();return e.jsxs(ge,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:"transparent",borderBottomWidth:0,borderTopWidth:n>0?1:0,opacity:o.hidden?.5:void 0,...r},"data-testid":"row",innerRef:p,children:[e.jsx(l,{style:{flex:1,justifyContent:"center",alignItems:"flex-start",width:h},children:e.jsx(R,{type:"bare",style:{maxWidth:h},onPointerUp:g=>{g.stopPropagation(),m?.(o.id)},children:e.jsxs(l,{style:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},children:[e.jsx(P,{style:{...A.lineClamp(2),width:h,textAlign:"left",...A.smallText},"data-testid":"category-name",children:o.name}),e.jsx(ee,{style:{flexShrink:0,color:a.tableTextSubdued},width:14,height:14})]})})}),e.jsxs(l,{style:{flexDirection:"row",justifyContent:"flex-end",alignItems:"center"},children:[s&&e.jsx(l,{style:{width:y,justifyContent:"center",alignItems:"flex-end"},children:e.jsx(Ve,{name:"budgeted",binding:s,categoryId:o.id,month:f,onBudgetAction:x,formatter:g=>e.jsx(R,{type:"bare",style:{...ce,maxWidth:y},children:e.jsx(H,{as:P,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:y,textAlign:"right",fontSize:12},children:c(g,"financial")},g)})})}),e.jsx(l,{style:{justifyContent:"center",alignItems:"flex-end",width:y,paddingRight:5},children:e.jsx($,{binding:u,type:"financial",formatter:g=>e.jsx(H,{as:P,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:y,textAlign:"right",fontSize:12},children:c(g,"financial")},g)})})]})]})}),Zt=T.memo(function({type:n,group:o,editMode:s,onEditGroup:u,onEditCategory:f,month:r,onAddCategory:m,onBudgetAction:x,showBudgetedCol:p,show3Cols:c,showHiddenCategories:h,collapsed:y,onToggleCollapse:g}){function M(i){return i}return e.jsxs(ve,{style:{marginTop:4,marginBottom:4},children:[e.jsx(Jt,{group:o,showBudgetedCol:p,budgeted:n==="report"?z.groupBudgeted(o.id):L.groupBudgeted(o.id),spent:n==="report"?z.groupSumAmount(o.id):L.groupSumAmount(o.id),balance:n==="report"?z.groupBalance(o.id):L.groupBalance(o.id),show3Cols:c,editMode:s,onAddCategory:m,onEdit:u,collapsed:y,onToggleCollapse:g}),o.categories.filter(i=>!y&&(!i.hidden||h)).map((i,S)=>e.jsx(Yt,{index:S,show3Cols:c,type:n,category:i,isHidden:!!i.hidden||o.hidden,goal:n==="report"?z.catGoal(i.id):L.catGoal(i.id),longGoal:n==="report"?z.catLongGoal(i.id):L.catLongGoal(i.id),budgeted:n==="report"?z.catBudgeted(i.id):L.catBudgeted(i.id),spent:n==="report"?z.catSumAmount(i.id):L.catSumAmount(i.id),balance:n==="report"?z.catBalance(i.id):L.catBalance(i.id),carryover:n==="report"?z.catCarryover(i.id):L.catCarryover(i.id),style:{backgroundColor:a.tableBackground},showBudgetedCol:p,editMode:s,onEdit:f,month:r,onBudgetAction:x},i.id))]})});function en({type:t,group:n,month:o,onAddCategory:s,showHiddenCategories:u,editMode:f,onEditGroup:r,onEditCategory:m,onBudgetAction:x,collapsed:p,onToggleCollapse:c}){const h=U();return e.jsxs(l,{children:[e.jsxs(l,{style:{flexDirection:"row",alignItems:"center",justifyContent:"flex-end",marginTop:50,marginBottom:5,marginRight:15},children:[t==="report"&&e.jsx(J,{title:"Budgeted",style:{width:h}}),e.jsx(J,{title:"Received",style:{width:h}})]}),e.jsxs(ve,{style:{marginTop:0},children:[e.jsx(Kt,{group:n,budgeted:t==="report"?z.groupBudgeted(n.id):null,balance:t==="report"?z.groupSumAmount(n.id):L.groupSumAmount(n.id),onAddCategory:s,editMode:f,onEdit:r,collapsed:p,onToggleCollapse:c}),n.categories.filter(y=>!p&&(!y.hidden||u)).map((y,g)=>e.jsx(Xt,{index:g,category:y,month:o,type:t,budgeted:t==="report"?z.catBudgeted(y.id):null,balance:t==="report"?z.catSumAmount(y.id):L.catSumAmount(y.id),style:{backgroundColor:a.tableBackground},editMode:f,onEdit:m,onBudgetAction:x},y.id))]})]})}function tn({type:t,categoryGroups:n,onEditGroup:o,onEditCategory:s,editMode:u,gestures:f,month:r,onSaveCategory:m,onDeleteCategory:x,onAddCategory:p,onReorderCategory:c,onReorderGroup:h,onBudgetAction:y,showBudgetedCol:g,show3Cols:M,showHiddenCategories:i}){const S=Je(w=>({incomeGroup:w.find(W=>W.is_income),expenseGroups:w.filter(W=>!W.is_income)})),{incomeGroup:I,expenseGroups:v}=S(n),[D=[],O]=G("budget.collapsed"),V=w=>{O(D.includes(w)?D.filter(W=>W!==w):[...D,w])};return e.jsxs(l,{"data-testid":"budget-groups",style:{flex:"1 0 auto",overflowY:"auto",paddingBottom:15},children:[v.filter(w=>!w.hidden||i).map(w=>e.jsx(Zt,{type:t,group:w,showBudgetedCol:g,gestures:f,month:r,editMode:u,onEditGroup:o,onEditCategory:s,onSaveCategory:m,onDeleteCategory:x,onAddCategory:p,onReorderCategory:c,onReorderGroup:h,onBudgetAction:y,show3Cols:M,showHiddenCategories:i,collapsed:D.includes(w.id),onToggleCollapse:V},w.id)),I&&e.jsx(en,{type:t,group:I,month:r,onAddCategory:p,onSaveCategory:m,onDeleteCategory:x,showHiddenCategories:i,editMode:u,onEditGroup:o,onEditCategory:s,onBudgetAction:y,collapsed:D.includes(I.id),onToggleCollapse:V})]})}function nn({type:t,categoryGroups:n,month:o,monthBounds:s,onPrevMonth:u,onNextMonth:f,onSaveGroup:r,onDeleteGroup:m,onAddCategory:x,onSaveCategory:p,onDeleteCategory:c,onReorderCategory:h,onReorderGroup:y,onShowBudgetSummary:g,onBudgetAction:M,onRefresh:i,onEditGroup:S,onEditCategory:I,onOpenBudgetPageMenu:v,onOpenBudgetMonthMenu:D}){const{width:O}=Qe(),V=O>=360,[w=!1,W]=G("mobile.showSpentColumn");function q(){W(!w)}const[K=!1]=G("budget.showHiddenCategories"),Y={backgroundColor:"transparent",color:"white"};return e.jsxs(we,{padding:0,header:e.jsx(Ce,{title:e.jsx(sn,{month:o,monthBounds:s,onOpenMonthMenu:D,onPrevMonth:u,onNextMonth:f}),leftContent:e.jsxs(R,{type:"bare",style:{color:a.mobileHeaderText,margin:10},hoveredStyle:Y,activeStyle:Y,onPointerUp:B=>{B.stopPropagation(),v?.()},children:[e.jsx(qe,{width:"20",height:"20"}),e.jsx(ee,{style:{flexShrink:0,color:a.mobileHeaderTextSubdued},width:"14",height:"14"})]})}),children:[e.jsx(on,{type:t,month:o,show3Cols:V,showSpentColumn:w,toggleSpentColumn:q,onShowBudgetSummary:g}),e.jsx(ze,{onRefresh:i,children:e.jsx(l,{"data-testid":"budget-table",style:{backgroundColor:a.pageBackground,paddingBottom:Fe},children:e.jsx(tn,{type:t,categoryGroups:n,showBudgetedCol:!w,show3Cols:V,showHiddenCategories:K,month:o,onEditGroup:S,onEditCategory:I,onSaveCategory:p,onDeleteCategory:c,onAddCategory:x,onSaveGroup:r,onDeleteGroup:m,onReorderCategory:h,onReorderGroup:y,onBudgetAction:M})})})]})}function on({show3Cols:t,type:n,month:o,onShowBudgetSummary:s,showSpentColumn:u,toggleSpentColumn:f}){const r=te(),m={padding:0,backgroundColor:"transparent",borderRadius:"unset"},x=U({show3Cols:t,isSidebar:!0}),p=U({show3Cols:t});return e.jsxs(l,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",flexShrink:0,padding:"10px 15px",paddingLeft:10,backgroundColor:a.tableRowHeaderBackground,borderBottomWidth:1,borderColor:a.tableBorder},children:[e.jsx(l,{style:{width:x,flexDirection:"row",justifyContent:"flex-start",alignItems:"center"},children:n==="report"?e.jsx(qt,{projected:o>=Re(),onClick:s,show3Cols:t}):e.jsx(Qt,{toBudget:L.toBudget,onClick:s,show3Cols:t})}),e.jsxs(l,{style:{flexDirection:"row",justifyContent:"flex-end",alignItems:"center"},children:[(t||!u)&&e.jsx(l,{style:{width:p,alignItems:"flex-end"},children:e.jsx(R,{type:"bare",disabled:t,onPointerUp:c=>{c.stopPropagation(),f()},style:m,children:e.jsxs(l,{style:{alignItems:"flex-end"},children:[e.jsxs(l,{style:{flexDirection:"row",alignItems:"center"},children:[!t&&e.jsx(Be,{width:12,height:12,style:{color:a.pageTextSubdued,marginRight:5}}),e.jsx(J,{title:"Budgeted",style:{color:a.formInputText}})]}),e.jsx($,{binding:n==="report"?z.totalBudgetedExpense:L.totalBudgeted,type:"financial",formatter:c=>e.jsx(H,{as:P,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:p,color:a.formInputText,paddingLeft:5,textAlign:"right",fontSize:12,fontWeight:"500"},children:r(c,"financial")},c)})]})})}),(t||u)&&e.jsx(l,{style:{width:p,alignItems:"flex-end"},children:e.jsx(R,{type:"bare",disabled:t,onPointerUp:c=>{c.stopPropagation(),f()},style:m,children:e.jsxs(l,{style:{alignItems:"flex-end"},children:[e.jsxs(l,{style:{flexDirection:"row",alignItems:"center"},children:[!t&&e.jsx(Be,{width:12,height:12,style:{color:a.pageTextSubdued,marginRight:5}}),e.jsx(J,{title:"Spent",style:{color:a.formInputText}})]}),e.jsx($,{binding:n==="report"?z.totalSpent:L.totalSpent,type:"financial",formatter:c=>e.jsx(H,{as:P,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:p,color:a.formInputText,paddingLeft:5,textAlign:"right",fontSize:12,fontWeight:"500"},children:r(c,"financial")},c)})]})})}),e.jsxs(l,{style:{width:p,alignItems:"flex-end"},children:[e.jsx(J,{title:"Balance",style:{color:a.formInputText}}),e.jsx($,{binding:n==="report"?z.totalLeftover:L.totalBalance,type:"financial",formatter:c=>e.jsx(H,{as:P,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:p,color:a.formInputText,paddingLeft:5,textAlign:"right",fontSize:12,fontWeight:"500"},children:r(c,"financial")},c)})]})]})]})}function sn({month:t,monthBounds:n,onOpenMonthMenu:o,onPrevMonth:s,onNextMonth:u}){const f=t>n.start,r=t<Me(n.end,1),m={padding:10,margin:2};return e.jsxs(l,{style:{flex:1,justifyContent:"center",alignItems:"center",flexDirection:"row"},children:[e.jsx(R,{type:"bare",onPointerUp:x=>{x.stopPropagation(),f&&s()},style:{...A.noTapHighlight,...m,opacity:f?1:.6,color:a.mobileHeaderText},hoveredStyle:{color:a.mobileHeaderText,background:a.mobileHeaderTextHover},children:e.jsx(Vt,{width:"15",height:"15",style:{margin:-5}})}),e.jsx(P,{style:{color:a.mobileHeaderText,textAlign:"center",fontSize:16,fontWeight:500,margin:"0 5px",...A.underlinedText},onPointerUp:x=>{x.stopPropagation(),o?.(t)},children:Le(t,"MMMM ‘yy")}),e.jsx(R,{type:"bare",onPointerUp:x=>{x.stopPropagation(),r&&u()},style:{...A.noTapHighlight,...m,opacity:r?1:.6,color:a.mobileHeaderText},hoveredStyle:{color:a.mobileHeaderText,background:a.mobileHeaderTextHover},children:e.jsx(Ye,{width:"15",height:"15",style:{margin:-5}})})]})}function an(t){const{categoryGroups:n,categories:o,budgetType:s,spreadsheet:u}=t,f=Re(),[r=f,m]=G("budget.startMonth"),[x,p]=T.useState({start:r,end:r}),[c,h]=T.useState(!1),[y]=G("numberFormat"),g=y||"comma-dot",[M=!1]=G("hideFraction"),i=ne();T.useEffect(()=>{async function d(){const{start:j,end:F}=await Z("get-budget-bounds");p({start:j,end:F}),await Se(s,u,r),h(!0)}d();const b=Ge("sync-event",({type:j,tables:F})=>{j==="success"&&(F.includes("categories")||F.includes("category_mapping")||F.includes("category_groups"))&&i(nt())});return()=>b()},[s,r,i,u]);const S=async(d,b,j)=>{i(rt(d,b,j))},I=()=>{i(s==="report"?k("report-budget-summary",{month:r}):k("rollover-budget-summary",{month:r,onBudgetAction:S}))},v=()=>{i(k("new-category-group",{onValidate:d=>d?null:"Name is required.",onSubmit:async d=>{i(E("budget-page-menu")),i(mt(d))}}))},D=(d,b)=>{i(k("new-category",{onValidate:j=>j?null:"Name is required.",onSubmit:async j=>{i(E("category-group-menu")),i(lt(j,d,b,!1))}}))},O=d=>{i(dt(d))},V=async d=>{const b=n?.find(F=>F.id===d);if(!b)return;let j=!1;for(const F of b.categories??[])if(await Z("must-category-transfer",{id:F.id})){j=!0;break}j?i(k("confirm-category-delete",{group:d,onDelete:F=>{i(E("category-group-menu")),i(Ie(d,F))}})):(i(E("category-group-menu")),i(Ie(d)))},w=d=>{const b=n.find(j=>j.id===d);O({...b,hidden:!b.hidden}),i(E("category-group-menu"))},W=d=>{i(ct(d))},q=async d=>{await Z("must-category-transfer",{id:d})?i(k("confirm-category-delete",{category:d,onDelete:j=>{d!==j&&(i(E("category-menu")),i(ke(d,j)))}})):(i(E("category-menu")),i(ke(d)))},K=d=>{const b=o.find(j=>j.id===d);W({...b,hidden:!b.hidden}),i(E("category-menu"))},Y=(d,{inGroup:b,aroundCategory:j})=>{let F,re;if(b)F=b;else if(j){const{id:Oe,position:_e}=j;let le=Oe;const se=n.find(de=>de.categories?.find(je=>je.id===le));if(_e==="bottom"){const de=se?.categories?.findIndex(je=>je.id===le)??-1;le=se?.categories&&de<se.categories.length-1?se.categories[de+1].id:null}F=se?.id,re=le}i(ut(d,F,re))},B=(d,b,j)=>{if(j==="bottom"){const F=n.findIndex(re=>re.id===b);b=F<n.length-1?n[F+1].id:null}i(gt(d,b))},_=async()=>{const d=Me(r,1);await Se(s,u,d),m(d),h(!0)},N=async()=>{const d=xt(r,1);await Se(s,u,d),m(d),h(!0)},oe=async(d,b)=>{await Z("notes-save",{id:d,note:b})},xe=d=>{const b=n.find(j=>j.id===d);i(k("notes",{id:d,name:b.name,onSave:oe}))},me=d=>{const b=o.find(j=>j.id===d);i(k("notes",{id:d,name:b.name,onSave:oe}))},fe=d=>{const b=n.find(j=>j.id===d);i(k("category-group-menu",{groupId:b.id,onSave:O,onAddCategory:D,onEditNotes:xe,onDelete:V,onToggleVisibility:w}))},ie=d=>{const b=o.find(j=>j.id===d);i(k("category-menu",{categoryId:b.id,onSave:W,onEditNotes:me,onDelete:q,onToggleVisibility:K,onBudgetAction:S}))},[he,pe]=G("budget.showHiddenCategories"),ae=()=>{pe(!he),i(E("budget-page-menu"))},Q=d=>{i(k("notes",{id:`budget-${d}`,name:Le(d,"MMMM ‘yy"),onSave:oe}))},ye=()=>{i(k("budget-list"))},C=d=>{i(k(`${s}-budget-month-menu`,{month:d,onBudgetAction:S,onEditNotes:Q}))},be=()=>{i(k("budget-page-menu",{onAddCategoryGroup:v,onToggleHiddenCategories:ae,onSwitchBudgetFile:ye}))};return!n||!c?e.jsx(l,{style:{flex:1,backgroundColor:a.mobilePageBackground,alignItems:"center",justifyContent:"center",marginBottom:25},children:e.jsx(ot,{width:25,height:25})}):e.jsx(it.Provider,{value:st(r),children:e.jsx(Ot,{onSync:async()=>{i(at())},children:({onRefresh:d})=>e.jsx(nn,{categoryGroups:n,type:s,month:r,monthBounds:x,onShowBudgetSummary:I,onPrevMonth:_,onNextMonth:N,onSaveGroup:O,onDeleteGroup:V,onAddCategory:D,onSaveCategory:W,onDeleteCategory:q,onReorderCategory:Y,onReorderGroup:B,onBudgetAction:S,onRefresh:d,onEditGroup:fe,onEditCategory:ie,onOpenBudgetPageMenu:be,onOpenBudgetMonthMenu:C},`${g}${M}`)})})}function mn(){const{list:t,grouped:n}=et(),[o]=G("budgetType"),s=o||"rollover",u=tt();return Te(a.mobileViewTheme),e.jsx(an,{categoryGroups:n,categories:t,budgetType:s,spreadsheet:u})}function Ae({name:t,amount:n,style:o={}}){return e.jsxs(l,{style:{flex:1,flexDirection:"row",marginTop:10,marginRight:10,color:a.pageTextLight,width:"100%",...o},children:[e.jsx(l,{style:{flex:1},children:e.jsx(P,{style:{...A.text,fontSize:14},"data-testid":"name",children:t})}),e.jsx($,{binding:n,style:{...A.text,fontSize:14},type:"financial"})]})}function We({account:t,updated:n,connected:o,pending:s,failed:u,getBalanceQuery:f,onSelect:r}){return e.jsx(l,{style:{flex:1,flexDirection:"row",backgroundColor:a.tableBackground,boxShadow:`0 1px 1px ${a.mobileAccountShadow}`,borderRadius:6,marginTop:10,marginRight:10,width:"100%"},"data-testid":"account",children:e.jsxs(Ne,{onPress:()=>r(t.id),style:({isPressed:m})=>({flexDirection:"row",border:"1px solid "+a.pillBorder,flex:1,alignItems:"center",borderRadius:6,...m&&{opacity:.1}}),children:[e.jsx(l,{style:{flex:1,margin:"10px 0"},children:e.jsxs(l,{style:{flexDirection:"row",alignItems:"center"},children:[t.bankId&&e.jsx(l,{style:{backgroundColor:s?a.sidebarItemBackgroundPending:u?a.sidebarItemBackgroundFailed:a.sidebarItemBackgroundPositive,marginRight:"8px",width:8,height:8,borderRadius:8,opacity:o?1:0}}),e.jsx(jt,{style:{...A.text,fontSize:17,fontWeight:600,color:n?a.mobileAccountText:a.pillText,paddingRight:30},"data-testid":"account-name",children:t.name})]})}),e.jsx($,{binding:f(t),type:"financial",style:{fontSize:16,color:"inherit"},getStyle:St,"data-testid":"account-balance"})]})})}function rn(){return e.jsx(l,{style:{flex:1,padding:30},children:e.jsx(P,{style:A.text,children:"For Actual to be useful, you need to add an account. You can link an account to automatically download transactions, or manage it locally yourself."})})}function ln({accounts:t,updatedAccounts:n,getBalanceQuery:o,getOnBudgetBalance:s,getOffBudgetBalance:u,onAddAccount:f,onSelectAccount:r,onSync:m}){const x=Ee(),p=Pe(g=>g.account.accountsSyncing),c=t.filter(g=>g.offbudget===0),h=t.filter(g=>g.offbudget===1),y={backgroundColor:"transparent",color:"white"};return e.jsxs(we,{header:e.jsx(Ce,{title:"Accounts",rightContent:e.jsx(Ne,{variant:"bare",style:({isHovered:g,isPressed:M})=>({color:a.mobileHeaderText,margin:10,...g||M?y:{}}),onPress:f,children:e.jsx(yt,{width:20,height:20})})}),padding:0,style:{paddingBottom:Fe},children:[t.length===0&&e.jsx(rn,{}),e.jsx(ze,{onRefresh:m,children:e.jsxs(l,{style:{margin:10},children:[c.length>0&&e.jsx(Ae,{name:"For Budget",amount:s()}),c.map(g=>e.jsx(We,{account:g,updated:n&&n.includes(g.id),connected:!!g.bank,pending:p.includes(g.id),failed:x&&x.has(g.id),getBalanceQuery:o,onSelect:r},g.id)),h.length>0&&e.jsx(Ae,{name:"Off Budget",amount:u(),style:{marginTop:30}}),h.map(g=>e.jsx(We,{account:g,updated:n&&n.includes(g.id),connected:!!g.bank,pending:p.includes(g.id),failed:x&&x.has(g.id),getBalanceQuery:o,onSelect:r},g.id))]})})]})}function fn(){const t=ne(),n=ft(),o=Pe(c=>c.queries.updatedAccounts),[s]=G("numberFormat"),u=s||"comma-dot",[f=!1]=G("hideFraction"),r=ue(),m=c=>{r(`/accounts/${c}`)},x=()=>{t(bt("add-account"))},p=()=>{t(Ue())};return Te(a.mobileViewTheme),e.jsx(l,{style:{flex:1},children:e.jsx(ln,{accounts:n.filter(c=>!c.closed),updatedAccounts:o,getBalanceQuery:$e,getOnBudgetBalance:ht,getOffBudgetBalance:pt,onAddAccount:x,onSelectAccount:m,onSync:p},u+f)})}function dn({account:t,pending:n,failed:o}){const s=wt(t.id);return e.jsx(we,{header:e.jsx(Ce,{title:e.jsx(cn,{account:t,pending:n,failed:o}),leftContent:e.jsx(Ct,{}),rightContent:e.jsx(Tt,{accountId:t.id})}),padding:0,children:e.jsx(Pt,{transform:s,children:e.jsx(un,{account:t})})})}function cn({account:t,pending:n,failed:o}){const s=ne(),u=c=>{s(Ht(c))},f=async(c,h)=>{await Z("notes-save",{id:c,note:h})},r=c=>{s(k("notes",{id:`account-${c}`,name:t.name,onSave:f}))},m=()=>{s(Dt(t.id))},x=()=>{s(Gt(t.id))},p=()=>{s(k("account-menu",{accountId:t.id,onSave:u,onEditNotes:r,onCloseAccount:m,onReopenAccount:x}))};return e.jsxs(l,{style:{flexDirection:"row"},children:[t.bankId&&e.jsx("div",{style:{margin:"auto",marginRight:5,width:8,height:8,borderRadius:8,backgroundColor:n?a.sidebarItemBackgroundPending:o?a.sidebarItemBackgroundFailed:a.sidebarItemBackgroundPositive,transition:"transform .3s"}}),e.jsx(P,{style:{...A.underlinedText,...A.lineClamp(2)},onClick:p,children:`${t.closed?"Closed: ":""}${t.name}`})]})}function un({account:t}){const[n,o]=T.useState(),[s,u]=T.useState(!1),[f,r]=T.useState(!0),[m,x]=T.useState([]),p=Nt(),c=T.useMemo(()=>s?m:p.concat(m),[s,p,m]),h=vt()||"MM/dd/yyyy";G("numberFormat");const y=ne(),g=ue(),M=async()=>{await y(Ue(t.id))},i=T.useCallback(()=>Bt(t.id).options({splits:"none"}),[t.id]),S=T.useRef(null),I=T.useCallback(B=>{S.current?.unsubscribe(),r(!0),S.current=It(B.options({splits:"none"}).select("*"),_=>{x(_),r(!1)},{pageCount:50})},[]),v=T.useCallback(()=>{const B=i();o(B),I(B)},[i,I]),D=()=>{S.current?.run()};T.useEffect(()=>{const B=Ge("sync-event",({type:_,tables:N})=>{_==="applied"&&((N.includes("transactions")||N.includes("category_mapping")||N.includes("payee_mapping"))&&D(),(N.includes("payees")||N.includes("payee_mapping"))&&y(kt()))});return v(),y(At(t.id)),()=>B()},[t.id,y,v]);const O=Wt(T.useCallback(B=>{B===""&&n?I(n):B&&n&&I(zt(n,B,h)),u(B!=="")},[n,h,I]),150),V=B=>{O(B)},w=B=>{Lt(B.id)?y(k("scheduled-transaction-menu",{transactionId:B.id,onPost:async _=>{const N=_.split("/");await Z("schedule/post-transaction",{id:N[1]}),y(E("scheduled-transaction-menu"))},onSkip:async _=>{const N=_.split("/");await Z("schedule/skip-next-date",{id:N[1]}),y(E("scheduled-transaction-menu"))}})):g(`/transactions/${B.id}`)},W=()=>{S.current?.fetchNext()},q=$e(t),K=Ft(t),Y=Rt(t);return e.jsx(Mt,{isLoading:f,transactions:c,balance:q,balanceCleared:K,balanceUncleared:Y,onLoadMore:W,searchPlaceholder:`Search ${t.name}`,onSearch:V,onSelectTransaction:w,onRefresh:M})}function hn(){const t=Ee(),n=Pe(x=>x.account.accountsSyncing),o=ue(),[s]=G("numberFormat"),u=s||"comma-dot",[f=!1]=G("hideFraction"),{id:r}=$t();Te(a.mobileViewTheme);const m=Et(r);return m?r==="budgeted"||r==="offbudget"||r==="uncategorized"?e.jsxs(l,{style:{flex:1,padding:30},children:[e.jsx(P,{style:{textAlign:"center"},children:"There is no Mobile View at the moment"}),e.jsx(R,{type:"normal",style:{fontSize:15,marginLeft:10,marginTop:10},onClick:()=>o("/accounts"),children:"Go back to Mobile Accounts"})]}):e.jsx(dn,{account:m,pending:n.includes(m.id),failed:t&&t.has(m.id)},u+f):null}export{hn as Account,fn as Accounts,mn as Budget};
//# sourceMappingURL=narrow.ltadGQJc.chunk.js.map
